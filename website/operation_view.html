<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert2/11.1.4/sweetalert2.min.css">  

<link href="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/css/tom-select.css" rel="stylesheet">

{%extends 'master.html'%}

{%block content%}
<div class="col-md-12">
  <div class="card">
      <div class="card-body">
        <h5 class="card-title" style="font-weight: bold;font-family: forte;">GESTION DES OPERATIONS</h5>

        <nav>
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="/">Dashboard</a></li>
            
            <li class="breadcrumb-item active">Operations</li>
          </ol>
        </nav>
      </div>


      <div class="card">
        <div class="card-body">
          <h5 class="card-title" style="font-weight:bold">Associez Des Paragraphes A L'operation: {{operation.nom}}</h5>
          
          <form class="row g-3" method="POST" action="/paragraphes_operations/">

            {%csrf_token%}
           <input type="text" value="{{operation.id}}" name="operation" style="display: none;">
            <div class="col-md-4">
              <div class="form-floating">
                <select class="form-control" name="paragraphe" id="paragraphe"> 
                    <option></option>
                    {%for paragraphes in paragraphe%}
                    <option value="{{paragraphes.id}}">{{paragraphes.nom}}</option>
                    {%endfor%}
                </select>
                <label for="floatingEmail"> Selectionnez Un Paragraphes</label>
              </div>
            </div>
            <div class="col-md-4">
              <div class="form-floating">
                  <select name="annee" id="annee" class="form-control">
                    <option></option>
                    {%for annees in annee%}
                    <option value="{{annees.id}}">{{annees.nom}}</option>
                    {%endfor%}
                  </select>
                <label for="floatingPassword">Etablissez Une Annee</label>
              </div>
            </div>
           
            <div class="col-md-4">
              <div class="col-md-12">
                <div class="form-floating">
                  <input type="number" class="form-control" id="montant" placeholder="Montant" name="montant"step="0.01">
                  <label for="floatingCity">Associez Un Montant Aux Paragraphe</label>
                </div>
              </div>
            </div>
          
            <div class="text-center">
              <button type="submit" class="btn btn-primary">Enregistrer</button>
              
            </div>
          </form>
        <hr class="p-2 bg-dark">
          <table class="table table-striped table-responsive">
            <thead>
              <tr>
         
                <th scope="col">Paragraphe</th>
                <th scope="col">Annee</th>
                <th scope="col">Montant</th>
                <th scope="col">Action</th>
              </tr>
            </thead>
            <tbody>
              
          {%for operation_details in operation_detail%}
          
          {%if operation.id == operation_details.idoperation_id%}
            <tr>
                <td>{{operation_details.idparagraphe.nom}}</td>
                <td>{{operation_details.idannee}}</td>
                <td>{{operation_details.montant}}</td>
                <td>
                <a href="/delete_operation/{{operations.id}}/" class="delete" ><i class="bi bi-archive" data-toggle="tooltip" title="Delete"></i></a>
              </td>
            </tr>
            {%endif%}
               {%endfor%}
            
            </tbody>
          </table>
        
        </div>
      </div>
      <script src="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/js/tom-select.complete.min.js"></script>
      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>  
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
      <script>
        new TomSelect("#annee",{
        persist: false,
        createOnBlur: true,
        create: true
      });
      </script>
      <script>
        new TomSelect("#paragraphe",{
        persist: false,
        createOnBlur: true,
        create: true
      });
      </script>
      {% for message in messages %}
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
       {% if message.tags == 'success' %}
      
      <script type="text/javascript">
       Swal.fire({
       position: "top-end",
       icon: "success",
       title: "{{message}}",
       showConfirmButton: false,
       timer: 2000
      });
      </script>
      {%endif%}
      {%endfor%}
      </script>
      {% for message in messages %}
      
       {% if message.tags == 'error' %}
      
      <script type="text/javascript">
       Swal.fire({
       position: "top-end",
       icon: "error",
       title: "{{message}}",
       showConfirmButton: false,
       timer: 5000
      });
      </script>
      {%endif%}
      {%endfor%}

{%endblock%}